
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Corrfunc.theory package &#8212; Corrfunc v0.0.4</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/corrfunc-logo-no-text.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Corrfunc.mocks package" href="Corrfunc.mocks.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Corrfunc.mocks.html" title="Corrfunc.mocks package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Corrfunc v0.0.4</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Comprehensive API reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Corrfunc.html" accesskey="U">Corrfunc package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Corrfunc.theory package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-Corrfunc.theory">
<span id="corrfunc-theory-package"></span><h1>Corrfunc.theory package<a class="headerlink" href="#module-Corrfunc.theory" title="Permalink to this headline">¶</a></h1>
<p>Wrapper for all clustering statistic calculations on galaxies
in a simulation volume.</p>
<dl class="py function">
<dt id="Corrfunc.theory.DD">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">DD</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">X1</span></em>, <em class="sig-param"><span class="n">Y1</span></em>, <em class="sig-param"><span class="n">Z1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">periodic</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">X2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">boxsize</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_ravg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/DD.html#DD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.DD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 3-D pair-counts corresponding to the real-space correlation
function, <span class="math notranslate nohighlight">\(\xi(r)\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the mean pair weight is stored in the
<code class="docutils literal notranslate"><span class="pre">&quot;weightavg&quot;</span></code> field of the results array.  The raw pair counts in the
<code class="docutils literal notranslate"><span class="pre">&quot;npairs&quot;</span></code> field are not weighted.  The weighting scheme depends on
<code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\xi(r)\)</span>. See
<a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a> for computing
<span class="math notranslate nohighlight">\(\xi(r)\)</span> from the pair counts returned.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – The number of OpenMP threads to use. Has no effect if OpenMP was not
enabled during library compilation.</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">r</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DD</span></code>. The file should contain white-space separated values
of (rmin, rmax)  for each <code class="docutils literal notranslate"><span class="pre">r</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">r</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>X1/Y1/Z1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – The array of X/Y/Z positions for the first set of points.
Calculations are done in the precision of the supplied arrays.</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> specifies how these weights are used;
results are returned in the <code class="docutils literal notranslate"><span class="pre">weightavg</span></code> field.  If only one of
weights1 and weights2 is specified, the other will be set to uniform
weights.</p></li>
<li><p><strong>periodic</strong> (<em>boolean</em>) – Boolean flag to indicate periodic boundary conditions.</p></li>
<li><p><strong>X2/Y2/Z2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – Array of XYZ positions for the second set of points. <em>Must</em> be the same
precision as the X1/Y1/Z1 arrays. Only required when <code class="docutils literal notranslate"><span class="pre">autocorr==0</span></code>.</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>boxsize</strong> (<em>double</em>) – The side-length of the cube in the cosmological simulation.
Present to facilitate exact calculations for periodic wrapping.
If boxsize is not supplied, then the wrapping is done based on
the maximum difference within each dimension of the X/Y/Z arrays.</p></li>
<li><p><strong>output_ravg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">r</span></code> for each bin. Code will
run slower if you set this flag.</p>
<p>Note: If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">ravg</span></code> will
suffer from numerical loss of precision and can not be trusted.
If you need accurate <code class="docutils literal notranslate"><span class="pre">ravg</span></code> values, then pass in double precision
arrays for the particle positions.</p>
</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional. Default: None.</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rmin, rmax, ravg, npairs,
weightavg] for each radial bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>. If
<code class="docutils literal notranslate"><span class="pre">output_ravg</span></code> is not set, then <code class="docutils literal notranslate"><span class="pre">ravg</span></code> will be set to 0.0 for all
bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number of
pairs in that bin and can be used to compute the actual
<span class="math notranslate nohighlight">\(\xi(r)\)</span> by combining with (DR, RR) counts.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.DD</span> <span class="kn">import</span> <span class="n">DD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../theory/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autocorr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">DD</span><span class="p">(</span><span class="n">autocorr</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">weights1</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span> <span class="n">output_ravg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10d}</span><span class="s2"> </span><span class="si">{4:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="gp">... </span>                        <span class="nb">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ravg&#39;</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span> 
<span class="go">  0.167536   0.238755   0.000000          0   0.000000</span>
<span class="go">  0.238755   0.340251   0.000000          0   0.000000</span>
<span class="go">  0.340251   0.484892   0.000000          0   0.000000</span>
<span class="go">  0.484892   0.691021   0.000000          0   0.000000</span>
<span class="go">  0.691021   0.984777   0.945372          2   1.000000</span>
<span class="go">  0.984777   1.403410   1.340525         10   1.000000</span>
<span class="go">  1.403410   2.000000   1.732968         36   1.000000</span>
<span class="go">  2.000000   2.850200   2.558878         54   1.000000</span>
<span class="go">  2.850200   4.061840   3.564959        208   1.000000</span>
<span class="go">  4.061840   5.788530   4.999278        674   1.000000</span>
<span class="go">  5.788530   8.249250   7.126673       2154   1.000000</span>
<span class="go">  8.249250  11.756000  10.201834       5996   1.000000</span>
<span class="go"> 11.756000  16.753600  14.517830      17746   1.000000</span>
<span class="go"> 16.753600  23.875500  20.716017      50252   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.theory.DDrppi">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">DDrppi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">pimax</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">X1</span></em>, <em class="sig-param"><span class="n">Y1</span></em>, <em class="sig-param"><span class="n">Z1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">periodic</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">X2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">boxsize</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_rpavg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/DDrppi.html#DDrppi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.DDrppi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 3-D pair-counts corresponding to the real-space correlation
function, <span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> or <span class="math notranslate nohighlight">\(\wp(r_p)\)</span>. Pairs which are
separated by less than the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins (specified in <code class="docutils literal notranslate"><span class="pre">binfile</span></code>) in the
X-Y plane, and less than <code class="docutils literal notranslate"><span class="pre">pimax</span></code> in the Z-dimension are
counted.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the mean pair weight is stored in the
<code class="docutils literal notranslate"><span class="pre">&quot;weightavg&quot;</span></code> field of the results array.  The raw pair counts in the
<code class="docutils literal notranslate"><span class="pre">&quot;npairs&quot;</span></code> field are not weighted.  The weighting scheme depends on
<code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>that this module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> or <span class="math notranslate nohighlight">\(wp(r_p)\)</span>. See the
utilities <a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a> and
<a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_rp_pi_counts_to_wp" title="Corrfunc.utils.convert_rp_pi_counts_to_wp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_rp_pi_counts_to_wp</span></code></a> for computing
<span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> and <span class="math notranslate nohighlight">\(wp(r_p)\)</span> respectively from the
pair counts.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – The number of OpenMP threads to use. Has no effect if OpenMP was not
enabled during library compilation.</p></li>
<li><p><strong>pimax</strong> (<em>double</em>) – <p>A double-precision value for the maximum separation along
the Z-dimension.</p>
<p>Distances along the :math:<code class="docutils literal notranslate"><span class="pre">\pi</span></code> direction are binned with unit
depth. For instance, if <code class="docutils literal notranslate"><span class="pre">pimax=40</span></code>, then 40 bins will be created
along the <code class="docutils literal notranslate"><span class="pre">pi</span></code> direction.</p>
<p>Note: Only pairs with <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">dz</span> <span class="pre">&lt;</span> <span class="pre">pimax</span></code> are counted (no equality).</p>
</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DDrppi</span></code>. The file should contain white-space separated values
of (rpmin, rpmax)  for each <code class="docutils literal notranslate"><span class="pre">rp</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">rp</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>X1/Y1/Z1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – The array of X/Y/Z positions for the first set of points.
Calculations are done in the precision of the supplied arrays.</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> specifies how these weights are used;
results are returned in the <code class="docutils literal notranslate"><span class="pre">weightavg</span></code> field.  If only one of
weights1 and weights2 is specified, the other will be set to uniform
weights.</p></li>
<li><p><strong>X2/Y2/Z2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – Array of XYZ positions for the second set of points. <em>Must</em> be the same
precision as the X1/Y1/Z1 arrays. Only required when <code class="docutils literal notranslate"><span class="pre">autocorr==0</span></code>.</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>periodic</strong> (<em>boolean</em>) – Boolean flag to indicate periodic boundary conditions.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>boxsize</strong> (<em>double</em>) – The side-length of the cube in the cosmological simulation.
Present to facilitate exact calculations for periodic wrapping.
If boxsize is not supplied, then the wrapping is done based on
the maximum difference within each dimension of the X/Y/Z arrays.</p></li>
<li><p><strong>output_rpavg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">rp</span></code> for each bin. Code will
run slower if you set this flag.</p>
<p>Note: If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will
suffer from numerical loss of precision and can not be trusted. If
you need accurate <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> values, then pass in double precision
arrays for the particle positions.</p>
</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rpmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional. Default: None.</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rpmin, rpmax, rpavg, pimax,
npairs, weightavg] for each radial bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>.
If <code class="docutils literal notranslate"><span class="pre">output_rpavg</span></code> is not set, then <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will be set to 0.0 for
all bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number
of pairs in that bin and can be used to compute <span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span>
by combining with (DR, RR) counts.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.DDrppi</span> <span class="kn">import</span> <span class="n">DDrppi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../theory/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autocorr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pimax</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">DDrppi</span><span class="p">(</span><span class="n">autocorr</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">pimax</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">weights1</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span> <span class="n">output_rpavg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">519</span><span class="p">:]:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10.1f}</span><span class="s2">&quot;</span>
<span class="gp">... </span>                              <span class="s2">&quot; </span><span class="si">{4:10d}</span><span class="s2"> </span><span class="si">{5:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rpavg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;pimax&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>                        
<span class="go"> 11.756000  16.753600  14.379250       40.0       1150   1.000000</span>
<span class="go"> 16.753600  23.875500  20.449131        1.0       2604   1.000000</span>
<span class="go"> 16.753600  23.875500  20.604834        2.0       2370   1.000000</span>
<span class="go"> 16.753600  23.875500  20.523989        3.0       2428   1.000000</span>
<span class="go"> 16.753600  23.875500  20.475181        4.0       2462   1.000000</span>
<span class="go"> 16.753600  23.875500  20.458005        5.0       2532   1.000000</span>
<span class="go"> 16.753600  23.875500  20.537162        6.0       2522   1.000000</span>
<span class="go"> 16.753600  23.875500  20.443087        7.0       2422   1.000000</span>
<span class="go"> 16.753600  23.875500  20.474580        8.0       2360   1.000000</span>
<span class="go"> 16.753600  23.875500  20.420360        9.0       2512   1.000000</span>
<span class="go"> 16.753600  23.875500  20.478355       10.0       2472   1.000000</span>
<span class="go"> 16.753600  23.875500  20.485268       11.0       2406   1.000000</span>
<span class="go"> 16.753600  23.875500  20.372985       12.0       2420   1.000000</span>
<span class="go"> 16.753600  23.875500  20.647998       13.0       2378   1.000000</span>
<span class="go"> 16.753600  23.875500  20.556208       14.0       2420   1.000000</span>
<span class="go"> 16.753600  23.875500  20.527992       15.0       2462   1.000000</span>
<span class="go"> 16.753600  23.875500  20.581017       16.0       2380   1.000000</span>
<span class="go"> 16.753600  23.875500  20.491819       17.0       2346   1.000000</span>
<span class="go"> 16.753600  23.875500  20.534440       18.0       2496   1.000000</span>
<span class="go"> 16.753600  23.875500  20.529129       19.0       2512   1.000000</span>
<span class="go"> 16.753600  23.875500  20.501946       20.0       2500   1.000000</span>
<span class="go"> 16.753600  23.875500  20.513349       21.0       2544   1.000000</span>
<span class="go"> 16.753600  23.875500  20.471915       22.0       2430   1.000000</span>
<span class="go"> 16.753600  23.875500  20.450651       23.0       2354   1.000000</span>
<span class="go"> 16.753600  23.875500  20.550753       24.0       2460   1.000000</span>
<span class="go"> 16.753600  23.875500  20.540262       25.0       2490   1.000000</span>
<span class="go"> 16.753600  23.875500  20.559572       26.0       2350   1.000000</span>
<span class="go"> 16.753600  23.875500  20.534245       27.0       2382   1.000000</span>
<span class="go"> 16.753600  23.875500  20.511302       28.0       2508   1.000000</span>
<span class="go"> 16.753600  23.875500  20.491632       29.0       2456   1.000000</span>
<span class="go"> 16.753600  23.875500  20.592493       30.0       2386   1.000000</span>
<span class="go"> 16.753600  23.875500  20.506234       31.0       2484   1.000000</span>
<span class="go"> 16.753600  23.875500  20.482109       32.0       2538   1.000000</span>
<span class="go"> 16.753600  23.875500  20.518463       33.0       2544   1.000000</span>
<span class="go"> 16.753600  23.875500  20.482515       34.0       2534   1.000000</span>
<span class="go"> 16.753600  23.875500  20.503124       35.0       2382   1.000000</span>
<span class="go"> 16.753600  23.875500  20.471307       36.0       2356   1.000000</span>
<span class="go"> 16.753600  23.875500  20.384231       37.0       2554   1.000000</span>
<span class="go"> 16.753600  23.875500  20.454012       38.0       2458   1.000000</span>
<span class="go"> 16.753600  23.875500  20.585543       39.0       2394   1.000000</span>
<span class="go"> 16.753600  23.875500  20.504965       40.0       2500   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.theory.DDsmu">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">DDsmu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">mu_max</span></em>, <em class="sig-param"><span class="n">nmu_bins</span></em>, <em class="sig-param"><span class="n">X1</span></em>, <em class="sig-param"><span class="n">Y1</span></em>, <em class="sig-param"><span class="n">Z1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">periodic</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">X2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Y2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">boxsize</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_savg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fast_divide_and_NR_steps</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">proj_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nprojbins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">projfn</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/DDsmu.html#DDsmu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.DDsmu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 2-D component values (e.g. pair-counts for the tophat basis) corresponding to the redshift-space
correlation function, <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span> Pairs which are separated
by less than the <code class="docutils literal notranslate"><span class="pre">s</span></code> bins (specified in <code class="docutils literal notranslate"><span class="pre">binfile</span></code>) in 3-D, and
less than <code class="docutils literal notranslate"><span class="pre">s*mu_max</span></code> in the Z-dimension are counted.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the mean pair weight is stored in the
<code class="docutils literal notranslate"><span class="pre">&quot;weightavg&quot;</span></code> field of the results array.  The raw pair counts in the
<code class="docutils literal notranslate"><span class="pre">&quot;npairs&quot;</span></code> field are not weighted.  The weighting scheme depends on
<code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span>. See the
utilities <a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a>
for computing <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span> from the pair counts.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – The number of OpenMP threads to use. Has no effect if OpenMP was not
enabled during library compilation.</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">s</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DDsmu_mocks</span></code>. The file should contain white-space separated values
of (smin, smax) specifying each <code class="docutils literal notranslate"><span class="pre">s</span></code> bin wanted. The bins
need to be contiguous and sorted in increasing order (smallest bins
come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">s</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>mu_max</strong> (<em>double. Must be in range</em><em> (</em><em>0.0</em><em>, </em><em>1.0</em><em>]</em>) – <p>A double-precision value for the maximum cosine of the angular
separation from the line of sight (LOS). Here, LOS is taken to be
along the Z direction.</p>
<p>Note: Only pairs with <span class="math notranslate nohighlight">\(0 &lt;= \cos(\theta_{LOS}) &lt; \mu_{max}\)</span>
are counted (no equality).</p>
</p></li>
<li><p><strong>nmu_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of linear <code class="docutils literal notranslate"><span class="pre">mu</span></code> bins, with the bins ranging from
from (0, <span class="math notranslate nohighlight">\(\mu_{max}\)</span>)</p></li>
<li><p><strong>X1/Y1/Z1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – The array of X/Y/Z positions for the first set of points.
Calculations are done in the precision of the supplied arrays.</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> specifies how these weights are used;
results are returned in the <code class="docutils literal notranslate"><span class="pre">weightavg</span></code> field.  If only one of
weights1 and weights2 is specified, the other will be set to uniform
weights.</p></li>
<li><p><strong>periodic</strong> (<em>boolean</em>) – Boolean flag to indicate periodic boundary conditions.</p></li>
<li><p><strong>X2/Y2/Z2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – Array of XYZ positions for the second set of points. <em>Must</em> be the same
precision as the X1/Y1/Z1 arrays. Only required when <code class="docutils literal notranslate"><span class="pre">autocorr==0</span></code>.</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>boxsize</strong> (<em>double</em>) – The side-length of the cube in the cosmological simulation.
Present to facilitate exact calculations for periodic wrapping.
If boxsize is not supplied, then the wrapping is done based on
the maximum difference within each dimension of the X/Y/Z arrays.</p></li>
<li><p><strong>output_savg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">s</span></code> for each bin. Code will
run slower if you set this flag. Also, note, if you are calculating
in single-precision, <code class="docutils literal notranslate"><span class="pre">s</span></code> will suffer from numerical loss of
precision and can not be trusted. If you need accurate <code class="docutils literal notranslate"><span class="pre">s</span></code>
values, then pass in double precision arrays for the particle
positions.</p></li>
<li><p><strong>fast_divide_and_NR_steps</strong> (<em>integer</em><em> (</em><em>default 0</em><em>)</em>) – Replaces the division in <code class="docutils literal notranslate"><span class="pre">AVX</span></code> implementation with an approximate
reciprocal, followed by <code class="docutils literal notranslate"><span class="pre">fast_divide_and_NR_steps</span></code> of Newton-Raphson.
Can improve runtime by ~15-20% on older computers. Value of 0 uses
the standard division operation.</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em> (</em><em>default</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>) </em><em>typical values in</em><em> [</em><em>1-3</em><em>]</em><em>)</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em> (</em><em>default 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em><em>)</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The type of pair weighting to apply.
Options: “pair_product”, None; Default: None.</p></li>
<li><p><strong>proj_type</strong> (<em>string</em><em> (</em><em>default None</em><em>)</em>) – Projection method to use; currently supported methods are [‘tophat’, ‘piecewise’, ‘generalr’, ‘gaussian_kernel’]</p></li>
<li><p><strong>nprojbins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>default None</em><em>)</em>) – Number of basis functions; necessary if projection method is defined</p></li>
<li><p><strong>projfn</strong> (<em>string</em><em> (</em><em>default None</em><em>)</em>) – Filename of projection file; necessary for proj_type=’generalr’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>A python list</em>) – A python list containing <code class="docutils literal notranslate"><span class="pre">nmu_bins</span></code> of [smin, smax, savg, mu_max,
npairs, weightavg] for each spatial bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>.
There will be a total of <code class="docutils literal notranslate"><span class="pre">nmu_bins</span></code> ranging from [0, <code class="docutils literal notranslate"><span class="pre">mu_max</span></code>)
<em>per</em> spatial bin. If <code class="docutils literal notranslate"><span class="pre">output_savg</span></code> is not set, then <code class="docutils literal notranslate"><span class="pre">savg</span></code> will
be set to 0.0 for all bins; similarly for <code class="docutils literal notranslate"><span class="pre">weight_avg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code>
contains the number of pairs in that bin.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
<li><p><strong>proj</strong> (<em>array-like, double, optional</em>) – Only returned if proj_type is not None. An array of length nprojbins of the computed component values (e.g. pair counts for the tophat basis)</p></li>
<li><p><strong>projt</strong> (<em>array-like, double, optional</em>) – Only returned if proj_type is not None. A tensor that is unrolled in the form of an array with length nprojbins*nprojbins, with the computed component values (e.g. pair counts for the tophat basis)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.DDsmu</span> <span class="kn">import</span> <span class="n">DDsmu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../theory/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autocorr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu_max</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nmu_bins</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">DDsmu</span><span class="p">(</span><span class="n">autocorr</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span> <span class="n">mu_max</span><span class="p">,</span> <span class="n">nmu_bins</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">weights1</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span> <span class="n">output_savg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">100</span><span class="p">:]:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10.1f}</span><span class="s2">&quot;</span>
<span class="gp">... </span>                              <span class="s2">&quot; </span><span class="si">{4:10d}</span><span class="s2"> </span><span class="si">{5:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;smin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;smax&#39;</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">r</span><span class="p">[</span><span class="s1">&#39;savg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;mu_max&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>                        
<span class="go"> 5.788530   8.249250   7.148213        0.1        230   1.000000</span>
<span class="go"> 5.788530   8.249250   7.157218        0.2        236   1.000000</span>
<span class="go"> 5.788530   8.249250   7.165338        0.3        208   1.000000</span>
<span class="go"> 5.788530   8.249250   7.079905        0.4        252   1.000000</span>
<span class="go"> 5.788530   8.249250   7.251661        0.5        184   1.000000</span>
<span class="go"> 5.788530   8.249250   7.118536        0.6        222   1.000000</span>
<span class="go"> 5.788530   8.249250   7.083466        0.7        238   1.000000</span>
<span class="go"> 5.788530   8.249250   7.198184        0.8        170   1.000000</span>
<span class="go"> 5.788530   8.249250   7.127409        0.9        208   1.000000</span>
<span class="go"> 5.788530   8.249250   6.973090        1.0        206   1.000000</span>
<span class="go"> 8.249250  11.756000  10.149183        0.1        592   1.000000</span>
<span class="go"> 8.249250  11.756000  10.213009        0.2        634   1.000000</span>
<span class="go"> 8.249250  11.756000  10.192220        0.3        532   1.000000</span>
<span class="go"> 8.249250  11.756000  10.246931        0.4        544   1.000000</span>
<span class="go"> 8.249250  11.756000  10.102675        0.5        530   1.000000</span>
<span class="go"> 8.249250  11.756000  10.276180        0.6        644   1.000000</span>
<span class="go"> 8.249250  11.756000  10.251264        0.7        666   1.000000</span>
<span class="go"> 8.249250  11.756000  10.138399        0.8        680   1.000000</span>
<span class="go"> 8.249250  11.756000  10.191916        0.9        566   1.000000</span>
<span class="go"> 8.249250  11.756000  10.243229        1.0        608   1.000000</span>
<span class="go">11.756000  16.753600  14.552776        0.1       1734   1.000000</span>
<span class="go">11.756000  16.753600  14.579991        0.2       1806   1.000000</span>
<span class="go">11.756000  16.753600  14.599611        0.3       1802   1.000000</span>
<span class="go">11.756000  16.753600  14.471100        0.4       1820   1.000000</span>
<span class="go">11.756000  16.753600  14.480192        0.5       1740   1.000000</span>
<span class="go">11.756000  16.753600  14.493679        0.6       1746   1.000000</span>
<span class="go">11.756000  16.753600  14.547713        0.7       1722   1.000000</span>
<span class="go">11.756000  16.753600  14.465390        0.8       1750   1.000000</span>
<span class="go">11.756000  16.753600  14.547465        0.9       1798   1.000000</span>
<span class="go">11.756000  16.753600  14.440975        1.0       1828   1.000000</span>
<span class="go">16.753600  23.875500  20.720406        0.1       5094   1.000000</span>
<span class="go">16.753600  23.875500  20.735403        0.2       5004   1.000000</span>
<span class="go">16.753600  23.875500  20.721069        0.3       5172   1.000000</span>
<span class="go">16.753600  23.875500  20.723648        0.4       5014   1.000000</span>
<span class="go">16.753600  23.875500  20.650621        0.5       5094   1.000000</span>
<span class="go">16.753600  23.875500  20.688135        0.6       5076   1.000000</span>
<span class="go">16.753600  23.875500  20.735691        0.7       4910   1.000000</span>
<span class="go">16.753600  23.875500  20.714097        0.8       4864   1.000000</span>
<span class="go">16.753600  23.875500  20.751836        0.9       4954   1.000000</span>
<span class="go">16.753600  23.875500  20.721183        1.0       5070   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.theory.vpf">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">vpf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rmax</span></em>, <em class="sig-param"><span class="n">nbins</span></em>, <em class="sig-param"><span class="n">nspheres</span></em>, <em class="sig-param"><span class="n">numpN</span></em>, <em class="sig-param"><span class="n">seed</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em>, <em class="sig-param"><span class="n">Z</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">periodic</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">boxsize</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/vpf.html#vpf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.vpf" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the counts-in-cells on 3-D real-space points.</p>
<p>Returns a numpy structured array containing the probability of a
sphere of radius up to <code class="docutils literal notranslate"><span class="pre">rmax</span></code> containing [0, numpN-1] galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>double</em>) – Maximum radius of the sphere to place on the particles</p></li>
<li><p><strong>nbins</strong> (<em>integer</em>) – Number of bins in the counts-in-cells. Radius of first shell
is rmax/nbins</p></li>
<li><p><strong>nspheres</strong> (<em>integer</em><em> (</em><em>&gt;= 0</em><em>)</em>) – Number of random spheres to place within the particle distribution.
For a small number of spheres, the error is larger in the measured
pN’s.</p></li>
<li><p><strong>numpN</strong> (<em>integer</em><em> (</em><em>&gt;= 1</em><em>)</em>) – <p>Governs how many unique pN’s are to returned. If <code class="docutils literal notranslate"><span class="pre">numpN</span></code> is set to 1,
then only the vpf (p0) is returned. For <code class="docutils literal notranslate"><span class="pre">numpN=2</span></code>, p0 and p1 are
returned.</p>
<p>More explicitly, the columns in the results look like the following:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>numpN</p></th>
<th class="head"><p>Columns in output</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>p0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>p0      p1</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>p0      p1     p2</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>p0      p1     p2     p3</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>and so on…</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">p0</span></code> is the vpf</p>
</p></li>
<li><p><strong>seed</strong> (<em>unsigned integer</em>) – Random number seed for the underlying GSL random number generator. Used
to draw centers of the spheres.</p></li>
<li><p><strong>X/Y/Z</strong> (<em>arraytype</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Particle positions in the 3 axes. Must be within [0, boxsize]
and specified in the same units as <code class="docutils literal notranslate"><span class="pre">rp_bins</span></code> and boxsize. All
3 arrays must be of the same floating-point type.</p>
<p>Calculations will be done in the same precision as these arrays,
i.e., calculations will be in floating point if XYZ are single
precision arrays (C float type); or in double-precision if XYZ
are double precision arrays (C double type).</p>
</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>periodic</strong> (<em>boolean</em>) – Boolean flag to indicate periodic boundary conditions.</p></li>
<li><p><strong>boxsize</strong> (<em>double</em>) – The side-length of the cube in the cosmological simulation.
Present to facilitate exact calculations for periodic wrapping.
If boxsize is not supplied, then the wrapping is done based on
the maximum difference within each dimension of the X/Y/Z arrays.</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – <p>Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p>
<p>Note: Since the counts in spheres calculation is symmetric
in all 3 dimensions, the defaults are different from the clustering
routines.</p>
</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>results</strong> – A numpy structured array containing [rmax, pN[numpN]] with <code class="docutils literal notranslate"><span class="pre">nbins</span></code>
elements. Each row contains the maximum radius of the sphere and the
<code class="docutils literal notranslate"><span class="pre">numpN</span></code> elements in the <code class="docutils literal notranslate"><span class="pre">pN</span></code> array. Each element of this array
contains the probability that a sphere of radius <code class="docutils literal notranslate"><span class="pre">rmax</span></code> contains
<em>exactly</em> <code class="docutils literal notranslate"><span class="pre">N</span></code> galaxies. For example, pN[0] (p0, the void probibility
function) is the probability that a sphere of radius <code class="docutils literal notranslate"><span class="pre">rmax</span></code> contains
zero galaxies.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set, then the return value is a tuple containing
(results, api_time). <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only the time spent within
the C library and ignores all python overhead.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy structured array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.vpf</span> <span class="kn">import</span> <span class="n">vpf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rmax</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nspheres</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpN</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">vpf</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">nspheres</span><span class="p">,</span> <span class="n">numpN</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.1f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>    
<span class="gp">... </span>    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.3f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pn</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>        
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> 
<span class="go">1.0      0.995      0.005      0.000      0.000      0.000</span>
<span class="go">2.0      0.956      0.044      0.001      0.000      0.000</span>
<span class="go">3.0      0.858      0.130      0.012      0.001      0.000</span>
<span class="go">4.0      0.695      0.252      0.047      0.005      0.001</span>
<span class="go">5.0      0.493      0.347      0.127      0.028      0.005</span>
<span class="go">6.0      0.295      0.362      0.219      0.091      0.026</span>
<span class="go">7.0      0.141      0.285      0.265      0.179      0.085</span>
<span class="go">8.0      0.056      0.159      0.228      0.229      0.161</span>
<span class="go">9.0      0.019      0.066      0.135      0.192      0.192</span>
<span class="go">10.0      0.003      0.019      0.054      0.106      0.150</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.theory.wp">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">wp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxsize</span></em>, <em class="sig-param"><span class="n">pimax</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em>, <em class="sig-param"><span class="n">Z</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_rpavg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">c_cell_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/wp.html#wp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.wp" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the projected correlation function in a
periodic cosmological box. Pairs which are separated by less
than the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins (specified in <code class="docutils literal notranslate"><span class="pre">binfile</span></code>) in the
X-Y plane, and less than <code class="docutils literal notranslate"><span class="pre">pimax</span></code> in the Z-dimension are
counted.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the resulting correlation function
is weighted.  The weighting scheme depends on <code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pairs are double-counted. And if <code class="docutils literal notranslate"><span class="pre">rpmin</span></code> is set to
0.0, then all the self-pairs (i’th particle with itself) are
added to the first bin =&gt; minimum number of pairs in the first bin
is the total number of particles.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boxsize</strong> (<em>double</em>) – A double-precision value for the boxsize of the simulation
in same units as the particle positions and the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins.</p></li>
<li><p><strong>pimax</strong> (<em>double</em>) – <p>A double-precision value for the maximum separation along
the Z-dimension.</p>
<p>Note: Only pairs with <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">dz</span> <span class="pre">&lt;</span> <span class="pre">pimax</span></code> are counted (no equality).</p>
</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads to use.</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">wp</span></code>. The file should contain white-space separated values
of (rpmin, rpmax)  for each <code class="docutils literal notranslate"><span class="pre">rp</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">rp</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>X/Y/Z</strong> (<em>arraytype</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Particle positions in the 3 axes. Must be within [0, boxsize]
and specified in the same units as <code class="docutils literal notranslate"><span class="pre">rp_bins</span></code> and boxsize. All
3 arrays must be of the same floating-point type.</p>
<p>Calculations will be done in the same precision as these arrays,
i.e., calculations will be in floating point if XYZ are single
precision arrays (C float type); or in double-precision if XYZ
are double precision arrays (C double type).</p>
</p></li>
<li><p><strong>weights</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> specifies how these weights are used;
results are returned in the <code class="docutils literal notranslate"><span class="pre">weightavg</span></code> field.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>output_rpavg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">rp</span></code> for each bin. Code will
run slower if you set this flag.</p>
<p>Note: If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will
suffer from numerical loss of precision and can not be trusted. If
you need accurate <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> values, then pass in double precision
arrays for the particle positions.</p>
</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rpmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>c_cell_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent <strong>per cell-pair</strong> within the
C libraries. A very detailed timer that stores information about the
number of particles in each cell, the thread id that processed that
cell-pair and the amount of time in nano-seconds taken to process that
cell pair. This timer can be used to study the instruction set
efficiency, and load-balancing of the code.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional.  Default: None.</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rpmin, rpmax, rpavg, wp, npairs,
weightavg] for each radial specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>. If
<code class="docutils literal notranslate"><span class="pre">output_rpavg</span></code> is not set then <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will be set to 0.0 for all
bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">wp</span></code> contains the projected
correlation function while <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number of unique
pairs in that bin.  If using weights, <code class="docutils literal notranslate"><span class="pre">wp</span></code> will be weighted while
<code class="docutils literal notranslate"><span class="pre">npairs</span></code> will not be.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
<li><p><strong>cell_time</strong> (<em>list, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_cell_timer</span></code> is set. Contains
detailed stats about each cell-pair visited during pair-counting,
viz., number of particles in each of the cells in the pair, 1-D
cell-indices for each cell in the pair, time (in nano-seconds) to
process the pair and the thread-id for the thread that processed that
cell-pair.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.wp</span> <span class="kn">import</span> <span class="n">wp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../theory/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pimax</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">wp</span><span class="p">(</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">pimax</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10.6f}</span><span class="s2"> </span><span class="si">{4:10d}</span><span class="s2"> </span><span class="si">{5:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="gp">... </span>          <span class="nb">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">],</span>
<span class="gp">... </span>          <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rpavg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;wp&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>          
<span class="go">  0.167536   0.238755   0.000000  66.717143         18   1.000000</span>
<span class="go">  0.238755   0.340251   0.000000 -15.786045         16   1.000000</span>
<span class="go">  0.340251   0.484892   0.000000   2.998470         42   1.000000</span>
<span class="go">  0.484892   0.691021   0.000000 -15.779885         66   1.000000</span>
<span class="go">  0.691021   0.984777   0.000000 -11.966728        142   1.000000</span>
<span class="go">  0.984777   1.403410   0.000000  -9.699906        298   1.000000</span>
<span class="go">  1.403410   2.000000   0.000000 -11.698771        588   1.000000</span>
<span class="go">  2.000000   2.850200   0.000000   3.848375       1466   1.000000</span>
<span class="go">  2.850200   4.061840   0.000000  -0.921452       2808   1.000000</span>
<span class="go">  4.061840   5.788530   0.000000   0.454851       5802   1.000000</span>
<span class="go">  5.788530   8.249250   0.000000   1.428344      11926   1.000000</span>
<span class="go">  8.249250  11.756000   0.000000  -1.067885      23478   1.000000</span>
<span class="go"> 11.756000  16.753600   0.000000  -0.553319      47994   1.000000</span>
<span class="go"> 16.753600  23.875500   0.000000  -0.086433      98042   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.theory.xi">
<code class="sig-prename descclassname">Corrfunc.theory.</code><code class="sig-name descname">xi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxsize</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em>, <em class="sig-param"><span class="n">Z</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_ravg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/theory/xi.html#xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.theory.xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the projected correlation function in a
periodic cosmological box. Pairs which are separated by less
than the <code class="docutils literal notranslate"><span class="pre">r</span></code> bins (specified in <code class="docutils literal notranslate"><span class="pre">binfile</span></code>) in 3-D real space.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the resulting correlation function
is weighted.  The weighting scheme depends on <code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pairs are double-counted. And if <code class="docutils literal notranslate"><span class="pre">rmin</span></code> is set to
0.0, then all the self-pairs (i’th particle with itself) are
added to the first bin =&gt; minimum number of pairs in the first bin
is the total number of particles.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boxsize</strong> (<em>double</em>) – A double-precision value for the boxsize of the simulation
in same units as the particle positions and the <code class="docutils literal notranslate"><span class="pre">r</span></code> bins.</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads to use.</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">r</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">xi</span></code>. The file should contain white-space separated values
of (rmin, rmax)  for each <code class="docutils literal notranslate"><span class="pre">r</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">r</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>X/Y/Z</strong> (<em>arraytype</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Particle positions in the 3 axes. Must be within [0, boxsize]
and specified in the same units as <code class="docutils literal notranslate"><span class="pre">rp_bins</span></code> and boxsize. All
3 arrays must be of the same floating-point type.</p>
<p>Calculations will be done in the same precision as these arrays,
i.e., calculations will be in floating point if XYZ are single
precision arrays (C float type); or in double-precision if XYZ
are double precision arrays (C double type).</p>
</p></li>
<li><p><strong>weights</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> specifies how these weights are used;
results are returned in the <code class="docutils literal notranslate"><span class="pre">weightavg</span></code> field.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>output_ravg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">r</span></code> for each bin. Code will
run slower if you set this flag.</p>
<p>Note: If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will
suffer from numerical loss of precision and can not be trusted. If
you need accurate <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> values, then pass in double precision
arrays for the particle positions.</p>
</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).  Unless you are benchmarking the different instruction
sets, you should always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if
you <em>are</em> benchmarking, then the string supplied here gets translated
into an <code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional</em><em>, </em><em>Default: None.</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rmin, rmax, ravg, xi, npairs,
weightavg] for each radial specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>. If
<code class="docutils literal notranslate"><span class="pre">output_ravg</span></code> is not set then <code class="docutils literal notranslate"><span class="pre">ravg</span></code> will be set to 0.0 for all
bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">xi</span></code> contains the correlation
function while <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number of pairs in that bin.
If using weights, <code class="docutils literal notranslate"><span class="pre">xi</span></code> will be weighted while <code class="docutils literal notranslate"><span class="pre">npairs</span></code> will not be.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.theory.xi</span> <span class="kn">import</span> <span class="n">xi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../theory/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">xi</span><span class="p">(</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span> <span class="n">output_ravg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10.6f}</span><span class="s2"> </span><span class="si">{4:10d}</span><span class="s2"> </span><span class="si">{5:10.6f}</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ravg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>                  
<span class="go">  0.167536   0.238755   0.226592  -0.205733          4   1.000000</span>
<span class="go">  0.238755   0.340251   0.289277  -0.176729         12   1.000000</span>
<span class="go">  0.340251   0.484892   0.426819  -0.051829         40   1.000000</span>
<span class="go">  0.484892   0.691021   0.596187  -0.131853        106   1.000000</span>
<span class="go">  0.691021   0.984777   0.850100  -0.049207        336   1.000000</span>
<span class="go">  0.984777   1.403410   1.225112   0.028543       1052   1.000000</span>
<span class="go">  1.403410   2.000000   1.737153   0.011403       2994   1.000000</span>
<span class="go">  2.000000   2.850200   2.474588   0.005405       8614   1.000000</span>
<span class="go">  2.850200   4.061840   3.532018  -0.014098      24448   1.000000</span>
<span class="go">  4.061840   5.788530   5.022241  -0.010784      70996   1.000000</span>
<span class="go">  5.788530   8.249250   7.160648  -0.001588     207392   1.000000</span>
<span class="go">  8.249250  11.756000  10.207213  -0.000323     601002   1.000000</span>
<span class="go"> 11.756000  16.753600  14.541171   0.000007    1740084   1.000000</span>
<span class="go"> 16.753600  23.875500  20.728773  -0.001595    5028058   1.000000</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/corrfunc_logo_320px_240px.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="Corrfunc.mocks.html"
                        title="previous chapter">Corrfunc.mocks package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/Corrfunc.theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Corrfunc.mocks.html" title="Corrfunc.mocks package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Corrfunc v0.0.4</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Comprehensive API reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Corrfunc.html" >Corrfunc package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Corrfunc.theory package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2020, Kate Storey-Fisher &lt;kstoreyfisher@gmail.com&gt;.
      Last updated on Sep 14, 2020.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>