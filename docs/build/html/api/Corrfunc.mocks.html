
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Corrfunc.mocks package &#8212; Corrfunc v0.0.4</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/corrfunc-logo-no-text.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Corrfunc.theory package" href="Corrfunc.theory.html" />
    <link rel="prev" title="Corrfunc.bases package" href="Corrfunc.bases.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Corrfunc.theory.html" title="Corrfunc.theory package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Corrfunc.bases.html" title="Corrfunc.bases package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Corrfunc v0.0.4</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Comprehensive API reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Corrfunc.html" accesskey="U">Corrfunc package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Corrfunc.mocks package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-Corrfunc.mocks">
<span id="corrfunc-mocks-package"></span><h1>Corrfunc.mocks package<a class="headerlink" href="#module-Corrfunc.mocks" title="Permalink to this headline">¶</a></h1>
<p>Wrapper for all clustering statistic calculations on galaxies
in a mock catalog.</p>
<dl class="py function">
<dt id="Corrfunc.mocks.DDrppi_mocks">
<code class="sig-prename descclassname">Corrfunc.mocks.</code><code class="sig-name descname">DDrppi_mocks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">cosmology</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">pimax</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">RA1</span></em>, <em class="sig-param"><span class="n">DEC1</span></em>, <em class="sig-param"><span class="n">CZ1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">RA2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DEC2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">CZ2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_comoving_dist</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_rpavg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fast_divide_and_NR_steps</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/mocks/DDrppi_mocks.html#DDrppi_mocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.mocks.DDrppi_mocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 2-D pair-counts corresponding to the projected correlation
function, <span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span>. Pairs which are separated by less
than the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins (specified in <code class="docutils literal notranslate"><span class="pre">binfile</span></code>) in the
X-Y plane, and less than <code class="docutils literal notranslate"><span class="pre">pimax</span></code> in the Z-dimension are
counted. The input positions are expected to be on-sky co-ordinates.
This module is suitable for calculating correlation functions for mock
catalogs.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the resulting pair counts are weighted.  The
weighting scheme depends on <code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<p>Returns a numpy structured array containing the pair counts for the
specified bins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>that this module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> or <span class="math notranslate nohighlight">\(wp(r_p)\)</span>. See the
utilities <a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a> and
<a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_rp_pi_counts_to_wp" title="Corrfunc.utils.convert_rp_pi_counts_to_wp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_rp_pi_counts_to_wp</span></code></a> for computing
<span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> and <span class="math notranslate nohighlight">\(wp(r_p)\)</span> respectively from the
pair counts.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>cosmology</strong> (<em>integer</em><em>, </em><em>required</em>) – <p>Integer choice for setting cosmology. Valid values are 1-&gt;LasDamas
cosmology and 2-&gt;Planck cosmology. If you need arbitrary cosmology,
easiest way is to convert the <code class="docutils literal notranslate"><span class="pre">CZ</span></code> values into co-moving distance,
based on your preferred cosmology. Set <code class="docutils literal notranslate"><span class="pre">is_comoving_dist=True</span></code>, to
indicate that the co-moving distance conversion has already been done.</p>
<dl class="simple">
<dt>Choices:</dt><dd><ol class="arabic simple">
<li><p>LasDamas cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.25\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.75\)</span></p></li>
<li><p>Planck   cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.302\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.698\)</span></p></li>
</ol>
</dd>
</dl>
<p>To setup a new cosmology, add an entry to the function,
<code class="docutils literal notranslate"><span class="pre">init_cosmology</span></code> in <code class="docutils literal notranslate"><span class="pre">ROOT/utils/cosmology_params.c</span></code> and re-install
the entire package.</p>
</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – The number of OpenMP threads to use. Has no effect if OpenMP was not
enabled during library compilation.</p></li>
<li><p><strong>pimax</strong> (<em>double</em>) – <p>A double-precision value for the maximum separation along
the Z-dimension.</p>
<p>Distances along the <span class="math notranslate nohighlight">\(\pi\)</span> direction are binned with unit
depth. For instance, if <code class="docutils literal notranslate"><span class="pre">pimax=40</span></code>, then 40 bins will be created
along the <code class="docutils literal notranslate"><span class="pre">pi</span></code> direction. Only pairs with <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">dz</span> <span class="pre">&lt;</span> <span class="pre">pimax</span></code>
are counted (no equality).</p>
</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">rp</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DDrppi_mocks</span></code>. The file should contain white-space separated values
of (rpmin, rpmax)  for each <code class="docutils literal notranslate"><span class="pre">rp</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">rp</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>RA1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the first set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Calculations are done in the precision of the supplied arrays.</p>
</p></li>
<li><p><strong>DEC1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the first set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].</p>
<p>Must be of same precision type as RA1.</p>
</p></li>
<li><p><strong>CZ1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the first set of
points. Code will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If is_comoving_dist is set, then <code class="docutils literal notranslate"><span class="pre">CZ1</span></code> is interpreted as the
co-moving distance, rather than <cite>cz</cite>.</p>
</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or (n_positions,).
<cite>weight_type</cite> specifies how these weights are used; results are returned
in the <cite>weightavg</cite> field.  If only one of weights1 and weights2 is
specified, the other will be set to uniform weights.</p></li>
<li><p><strong>RA2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the second set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>DEC2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the second set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>CZ2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the second set of
points. Code will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If is_comoving_dist is set, then <code class="docutils literal notranslate"><span class="pre">CZ2</span></code> is interpreted as the
co-moving distance, rather than <cite>cz</cite>.</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>is_comoving_dist</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to indicate that <code class="docutils literal notranslate"><span class="pre">cz</span></code> values have already been
converted into co-moving distances. This flag allows arbitrary
cosmologies to be used in <code class="docutils literal notranslate"><span class="pre">Corrfunc</span></code>.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>output_rpavg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">rp</span></code> for each bin. Code will
run slower if you set this flag.</p>
<p>If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will suffer
suffer from numerical loss of precision and can not be trusted. If
you need accurate <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> values, then pass in double precision
arrays for the particle positions.</p>
</p></li>
<li><p><strong>fast_divide_and_NR_steps</strong> (<em>integer</em><em> (</em><em>default 0</em><em>)</em>) – Replaces the division in <code class="docutils literal notranslate"><span class="pre">AVX</span></code> implementation with an approximate
reciprocal, followed by <code class="docutils literal notranslate"><span class="pre">fast_divide_and_NR_steps</span></code> of Newton-Raphson.
Can improve runtime by ~15-20% on older computers. Value of 0 uses
the standard division operation.</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rpmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string, case-insensitive (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Possible
options are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code will
revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be available).</p>
<p>Unless you are benchmarking the different instruction sets, you should
always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if you <em>are</em>
benchmarking, then the string supplied here gets translated into an
<code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default None</em><em>)</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rpmin, rpmax, rpavg, pimax,
npairs, weightavg] for each radial bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>.
If <code class="docutils literal notranslate"><span class="pre">output_ravg</span></code> is not set, then <code class="docutils literal notranslate"><span class="pre">rpavg</span></code> will be set to 0.0 for
all bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number
of pairs in that bin and can be used to compute the actual
<span class="math notranslate nohighlight">\(\xi(r_p, \pi)\)</span> or <span class="math notranslate nohighlight">\(wp(rp)\)</span> by combining with
(DR, RR) counts.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.mocks.DDrppi_mocks</span> <span class="kn">import</span> <span class="n">DDrppi_mocks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../mocks/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span> <span class="n">Z</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_cz</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">CZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DEC</span> <span class="o">=</span> <span class="mf">90.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RA</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autocorr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmology</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pimax</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">DDrppi_mocks</span><span class="p">(</span><span class="n">autocorr</span><span class="p">,</span> <span class="n">cosmology</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">pimax</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span> <span class="n">RA</span><span class="p">,</span> <span class="n">DEC</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">weights1</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">output_rpavg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_comoving_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">519</span><span class="p">:]:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10.1f}</span><span class="s2">&quot;</span>
<span class="gp">... </span>                              <span class="s2">&quot; </span><span class="si">{4:10d}</span><span class="s2"> </span><span class="si">{5:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">r</span><span class="p">[</span><span class="s1">&#39;rpavg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;pimax&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>                        
<span class="go"> 11.359969  16.852277  14.285169       40.0     104850   1.000000</span>
<span class="go"> 16.852277  25.000000  21.181246        1.0     274144   1.000000</span>
<span class="go"> 16.852277  25.000000  21.190844        2.0     272876   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183321        3.0     272294   1.000000</span>
<span class="go"> 16.852277  25.000000  21.188486        4.0     272506   1.000000</span>
<span class="go"> 16.852277  25.000000  21.170832        5.0     272100   1.000000</span>
<span class="go"> 16.852277  25.000000  21.165379        6.0     271788   1.000000</span>
<span class="go"> 16.852277  25.000000  21.175246        7.0     270040   1.000000</span>
<span class="go"> 16.852277  25.000000  21.187417        8.0     269492   1.000000</span>
<span class="go"> 16.852277  25.000000  21.172066        9.0     269682   1.000000</span>
<span class="go"> 16.852277  25.000000  21.182460       10.0     268266   1.000000</span>
<span class="go"> 16.852277  25.000000  21.170594       11.0     268744   1.000000</span>
<span class="go"> 16.852277  25.000000  21.178608       12.0     266820   1.000000</span>
<span class="go"> 16.852277  25.000000  21.187184       13.0     266510   1.000000</span>
<span class="go"> 16.852277  25.000000  21.184937       14.0     265484   1.000000</span>
<span class="go"> 16.852277  25.000000  21.180184       15.0     265258   1.000000</span>
<span class="go"> 16.852277  25.000000  21.191504       16.0     262952   1.000000</span>
<span class="go"> 16.852277  25.000000  21.187746       17.0     262602   1.000000</span>
<span class="go"> 16.852277  25.000000  21.189778       18.0     260206   1.000000</span>
<span class="go"> 16.852277  25.000000  21.188882       19.0     259410   1.000000</span>
<span class="go"> 16.852277  25.000000  21.185684       20.0     256806   1.000000</span>
<span class="go"> 16.852277  25.000000  21.194036       21.0     255574   1.000000</span>
<span class="go"> 16.852277  25.000000  21.184115       22.0     255406   1.000000</span>
<span class="go"> 16.852277  25.000000  21.178255       23.0     252394   1.000000</span>
<span class="go"> 16.852277  25.000000  21.184644       24.0     252220   1.000000</span>
<span class="go"> 16.852277  25.000000  21.187020       25.0     251668   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183827       26.0     249648   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183121       27.0     247160   1.000000</span>
<span class="go"> 16.852277  25.000000  21.180872       28.0     246238   1.000000</span>
<span class="go"> 16.852277  25.000000  21.185251       29.0     246030   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183488       30.0     242124   1.000000</span>
<span class="go"> 16.852277  25.000000  21.194538       31.0     242426   1.000000</span>
<span class="go"> 16.852277  25.000000  21.190702       32.0     239778   1.000000</span>
<span class="go"> 16.852277  25.000000  21.188985       33.0     239046   1.000000</span>
<span class="go"> 16.852277  25.000000  21.187092       34.0     237640   1.000000</span>
<span class="go"> 16.852277  25.000000  21.185515       35.0     236256   1.000000</span>
<span class="go"> 16.852277  25.000000  21.190278       36.0     233536   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183240       37.0     233274   1.000000</span>
<span class="go"> 16.852277  25.000000  21.183796       38.0     231628   1.000000</span>
<span class="go"> 16.852277  25.000000  21.200668       39.0     230378   1.000000</span>
<span class="go"> 16.852277  25.000000  21.181153       40.0     229006   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.mocks.DDsmu_mocks">
<code class="sig-prename descclassname">Corrfunc.mocks.</code><code class="sig-name descname">DDsmu_mocks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">cosmology</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">mu_max</span></em>, <em class="sig-param"><span class="n">nmu_bins</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">RA1</span></em>, <em class="sig-param"><span class="n">DEC1</span></em>, <em class="sig-param"><span class="n">CZ1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">RA2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DEC2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">CZ2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_comoving_dist</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_savg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fast_divide_and_NR_steps</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">proj_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nprojbins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">projfn</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/mocks/DDsmu_mocks.html#DDsmu_mocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.mocks.DDsmu_mocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 2-D pair-counts corresponding to the projected correlation
function, <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span>. The pairs are counted in bins of
radial separation and cosine of angle to the line-of-sight (LOS). The
input positions are expected to be on-sky co-ordinates. This module is
suitable for calculating correlation functions for mock catalogs.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the resulting pair counts are weighted.  The
weighting scheme depends on <code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<p>Returns a numpy structured array containing the pair counts for the
specified bins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span>. See the
utilities <a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a>
for computing <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span> from the pair counts.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>cosmology</strong> (<em>integer</em><em>, </em><em>required</em>) – <p>Integer choice for setting cosmology. Valid values are 1-&gt;LasDamas
cosmology and 2-&gt;Planck cosmology. If you need arbitrary cosmology,
easiest way is to convert the <code class="docutils literal notranslate"><span class="pre">CZ</span></code> values into co-moving distance,
based on your preferred cosmology. Set <code class="docutils literal notranslate"><span class="pre">is_comoving_dist=True</span></code>, to
indicate that the co-moving distance conversion has already been done.</p>
<dl class="simple">
<dt>Choices:</dt><dd><ol class="arabic simple">
<li><p>LasDamas cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.25\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.75\)</span></p></li>
<li><p>Planck   cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.302\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.698\)</span></p></li>
</ol>
</dd>
</dl>
<p>To setup a new cosmology, add an entry to the function,
<code class="docutils literal notranslate"><span class="pre">init_cosmology</span></code> in <code class="docutils literal notranslate"><span class="pre">ROOT/utils/cosmology_params.c</span></code> and re-install
the entire package.</p>
</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – The number of OpenMP threads to use. Has no effect if OpenMP was not
enabled during library compilation.</p></li>
<li><p><strong>mu_max</strong> (<em>double. Must be in range</em><em> [</em><em>0.0</em><em>, </em><em>1.0</em><em>]</em>) – <p>A double-precision value for the maximum cosine of the angular
separation from the line of sight (LOS). Here, <code class="docutils literal notranslate"><span class="pre">mu</span></code> is defined as
the angle between <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code>. If <span class="math notranslate nohighlight">\(v_1\)</span> and <span class="math notranslate nohighlight">\(v_2\)</span>
represent the vectors to each point constituting the pair, then
<span class="math notranslate nohighlight">\(s := v_1 - v_2\)</span> and <span class="math notranslate nohighlight">\(l := 1/2 (v_1 + v_2)\)</span>.</p>
<p>Note: Only pairs with <span class="math notranslate nohighlight">\(0 &lt;= \cos(\theta_{LOS}) &lt; \mu_{max}\)</span>
are counted (no equality).</p>
</p></li>
<li><p><strong>nmu_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of linear <code class="docutils literal notranslate"><span class="pre">mu</span></code> bins, with the bins ranging from
from (0, <span class="math notranslate nohighlight">\(\mu_{max}\)</span>)</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">s</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DDsmu_mocks</span></code>. The file should contain white-space separated values
of (smin, smax) specifying each <code class="docutils literal notranslate"><span class="pre">s</span></code> bin wanted. The bins
need to be contiguous and sorted in increasing order (smallest bins
come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">s</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0. This
array does not need to be sorted.</p>
</p></li>
<li><p><strong>RA1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the first set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Calculations are done in the precision of the supplied arrays.</p>
</p></li>
<li><p><strong>DEC1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the first set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].</p>
<p>Must be of same precision type as RA1.</p>
</p></li>
<li><p><strong>CZ1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the first set of
points. Code will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If is_comoving_dist is set, then <code class="docutils literal notranslate"><span class="pre">CZ1</span></code> is interpreted as the
co-moving distance, rather than <cite>cz</cite>.</p>
</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions)
or (n_positions,). <cite>weight_type</cite> specifies how these weights are used;
results are returned in the <cite>weightavg</cite> field.  If only one of
<code class="docutils literal notranslate"><span class="pre">weights1</span></code> or <code class="docutils literal notranslate"><span class="pre">weights2</span></code> is specified, the other will be set
to uniform weights.</p></li>
<li><p><strong>RA2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the second set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>DEC2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the second set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>CZ2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the second set of
points. Code will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If is_comoving_dist is set, then <code class="docutils literal notranslate"><span class="pre">CZ2</span></code> is interpreted as the
co-moving distance, rather than <cite>cz</cite>.</p>
<p>Must be of same precision type as RA1/DEC1/CZ1.</p>
</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>is_comoving_dist</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to indicate that <code class="docutils literal notranslate"><span class="pre">cz</span></code> values have already been
converted into co-moving distances. This flag allows arbitrary
cosmologies to be used in <code class="docutils literal notranslate"><span class="pre">Corrfunc</span></code>.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>output_savg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to output the average <code class="docutils literal notranslate"><span class="pre">s</span></code> for each bin. Code will
run slower if you set this flag. Also, note, if you are calculating
in single-precision, <code class="docutils literal notranslate"><span class="pre">savg</span></code> will suffer from numerical loss of
precision and can not be trusted. If you need accurate <code class="docutils literal notranslate"><span class="pre">savg</span></code>
values, then pass in double precision arrays for the particle
positions.</p></li>
<li><p><strong>fast_divide_and_NR_steps</strong> (<em>integer</em><em> (</em><em>default 0</em><em>)</em>) – Replaces the division in <code class="docutils literal notranslate"><span class="pre">AVX</span></code> implementation with an approximate
reciprocal, followed by <code class="docutils literal notranslate"><span class="pre">fast_divide_and_NR_steps</span></code> of Newton-Raphson.
Can improve runtime by ~15-20% on older computers. Value of 0 uses
the standard division operation.</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>,</em><em>1</em><em>)</em><em>; typically within</em><em> [</em><em>1-3</em><em>]</em>) – Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rpmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string, case-insensitive (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code will
revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be available).</p>
<p>Unless you are benchmarking the different instruction sets, you should
always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if you <em>are</em>
benchmarking, then the string supplied here gets translated into an
<code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default None</em><em>)</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
<li><p><strong>proj_type</strong> (<em>string</em><em> (</em><em>default None</em><em>)</em>) – Projection method to use; currently supported methods are [‘tophat’, ‘piecewise’, ‘generalr’, ‘gaussian_kernel’]</p></li>
<li><p><strong>nprojbins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>default None</em><em>)</em>) – Number of basis functions; necessary if projection method is defined</p></li>
<li><p><strong>projfn</strong> (<em>string</em><em> (</em><em>default None</em><em>)</em>) – Filename of projection file; necessary for proj_type=’generalr’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [smin, smax, savg, mumax,
npairs, weightavg]. There are a total of <code class="docutils literal notranslate"><span class="pre">nmu_bins</span></code> in <code class="docutils literal notranslate"><span class="pre">mu</span></code>
for each separation bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>, with <code class="docutils literal notranslate"><span class="pre">mumax</span></code>
being the upper limit of the <code class="docutils literal notranslate"><span class="pre">mu</span></code> bin. If <code class="docutils literal notranslate"><span class="pre">output_savg</span></code> is  not
set, then <code class="docutils literal notranslate"><span class="pre">savg</span></code> will be set to 0.0 for all bins; similarly for
<code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the number of pairs in that bin
and can be used to compute the actual <span class="math notranslate nohighlight">\(\xi(s, \mu)\)</span> by
combining with (DR, RR) counts.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
<li><p><strong>proj</strong> (<em>array-like, double, optional</em>) – Only returned if proj_type is not None. An array of length nprojbins of the computed component values (e.g. pair counts for the tophat basis)</p></li>
<li><p><strong>projt</strong> (<em>array-like, double, optional</em>) – Only returned if proj_type is not None. A tensor that is unrolled in the form of an array with length nprojbins*nprojbins, with the computed component values (e.g. pair counts for the tophat basis)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.mocks.DDtheta_mocks">
<code class="sig-prename descclassname">Corrfunc.mocks.</code><code class="sig-name descname">DDtheta_mocks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autocorr</span></em>, <em class="sig-param"><span class="n">nthreads</span></em>, <em class="sig-param"><span class="n">binfile</span></em>, <em class="sig-param"><span class="n">RA1</span></em>, <em class="sig-param"><span class="n">DEC1</span></em>, <em class="sig-param"><span class="n">weights1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">RA2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">DEC2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">link_in_dec</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">link_in_ra</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_thetaavg</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fast_acos</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ra_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">dec_refine_factor</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">enable_min_sep_opt</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em>, <em class="sig-param"><span class="n">weight_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/mocks/DDtheta_mocks.html#DDtheta_mocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.mocks.DDtheta_mocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the angular correlation function for points on
the sky (i.e., mock catalogs or observed galaxies).</p>
<p>Returns a numpy structured array containing the pair counts for the
specified angular bins.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weights</span></code> are provided, the resulting pair counts are weighted.  The
weighting scheme depends on <code class="docutils literal notranslate"><span class="pre">weight_type</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module only returns pair counts and not the actual
correlation function <span class="math notranslate nohighlight">\(\omega(      heta)\)</span>. See
<a class="reference internal" href="Corrfunc.html#Corrfunc.utils.convert_3d_counts_to_cf" title="Corrfunc.utils.convert_3d_counts_to_cf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Corrfunc.utils.convert_3d_counts_to_cf</span></code></a> for computing
<span class="math notranslate nohighlight">\(\omega(   heta)\)</span> from the pair counts returned.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr</strong> (<em>boolean</em><em>, </em><em>required</em>) – Boolean flag for auto/cross-correlation. If autocorr is set to 1,
then the second set of particle positions are not required.</p></li>
<li><p><strong>nthreads</strong> (<em>integer</em>) – Number of threads to use.</p></li>
<li><p><strong>binfile</strong> (<em>string</em><em> or </em><em>an list/array of floats. Units: degrees.</em>) – <p>For string input: filename specifying the <code class="docutils literal notranslate"><span class="pre">theta</span></code> bins for
<code class="docutils literal notranslate"><span class="pre">DDtheta_mocks</span></code>. The file should contain white-space separated values
of (thetamin, thetamax)  for each <code class="docutils literal notranslate"><span class="pre">theta</span></code> wanted. The bins need to be
contiguous and sorted in increasing order (smallest bins come first).</p>
<p>For array-like input: A sequence of <code class="docutils literal notranslate"><span class="pre">theta</span></code> values that provides the
bin-edges. For example,
<code class="docutils literal notranslate"><span class="pre">np.logspace(np.log10(0.1),</span> <span class="pre">np.log10(10.0),</span> <span class="pre">15)</span></code> is a valid
input specifying <strong>14</strong> (logarithmic) bins between 0.1 and 10.0
degrees. This array does not need to be sorted.</p>
</p></li>
<li><p><strong>RA1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the first set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Calculations are done in the precision of the supplied arrays.</p>
</p></li>
<li><p><strong>DEC1</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – Array of Declinations for the first set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].
Must be of same precision type as RA1.</p></li>
<li><p><strong>weights1</strong> (<em>array_like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – A scalar, or an array of weights of shape (n_weights, n_positions) or
(n_positions,). <cite>weight_type</cite> specifies how these weights are used;
results are returned in the <cite>weightavg</cite> field.  If only one of weights1
and weights2 is specified, the other will be set to uniform weights.</p></li>
<li><p><strong>RA2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – The array of Right Ascensions for the second set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].
Must be of same precision type as RA1/DEC1.</p></li>
<li><p><strong>DEC2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – Array of Declinations for the second set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].
Must be of same precision type as RA1/DEC1.</p></li>
<li><p><strong>weights2</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em><em>, </em><em>optional</em>) – Same as weights1, but for the second set of positions</p></li>
<li><p><strong>link_in_dec</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – Boolean flag to create lattice in Declination. Code runs faster with
this option. However, if the angular separations are too small, then
linking in declination might produce incorrect results. When running
for the first time, check your results by comparing with the output
of the code for <code class="docutils literal notranslate"><span class="pre">link_in_dec=False</span></code> and <code class="docutils literal notranslate"><span class="pre">link_in_ra=False</span></code>.</p></li>
<li><p><strong>link_in_ra</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to create lattice in Right Ascension. Setting this option
implies <code class="docutils literal notranslate"><span class="pre">link_in_dec=True</span></code>. Similar considerations as <code class="docutils literal notranslate"><span class="pre">link_in_dec</span></code>
described above.</p>
<p>If you disable both <code class="docutils literal notranslate"><span class="pre">link_in_dec</span></code> and <code class="docutils literal notranslate"><span class="pre">link_in_ra</span></code>, then
the code reduces to a brute-force pair counter. No lattices are created
at all. For very small angular separations, the brute-force method
might be the most numerically stable method.</p>
</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>output_thetaavg</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Boolean flag to output the average ``   heta`` for each bin. Code will
run slower if you set this flag.</p>
<p>If you are calculating in single-precision, <code class="docutils literal notranslate"><span class="pre">thetaavg</span></code> will
suffer from numerical loss of precision and can not be trusted. If you
need accurate <code class="docutils literal notranslate"><span class="pre">thetaavg</span></code> values, then pass in double precision arrays
for <code class="docutils literal notranslate"><span class="pre">RA/DEC</span></code>.</p>
<p>Code will run significantly slower if you enable this option.
Use the keyword <code class="docutils literal notranslate"><span class="pre">fast_acos</span></code> if you can tolerate some loss of
precision.</p>
</p></li>
<li><p><strong>fast_acos</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – <p>Flag to use numerical approximation for the <code class="docutils literal notranslate"><span class="pre">arccos</span></code> - gives better
performance at the expense of some precision. Relevant only if
<code class="docutils literal notranslate"><span class="pre">output_thetaavg==True</span></code>.</p>
<p>Developers: Two versions already coded up in <code class="docutils literal notranslate"><span class="pre">utils/fast_acos.h</span></code>,
so you can choose the version you want. There are also notes on how
to implement faster (and less accurate) functions, particularly
relevant if you know your <code class="docutils literal notranslate"><span class="pre">theta</span></code> range is limited. If you implement
a new version, then you will have to reinstall the entire Corrfunc
package.</p>
<p>Note: Tests will fail if you run the tests with``fast_acos=True``.</p>
</p></li>
<li><p><strong>(</strong><strong>radec</strong><strong>)</strong><strong>_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>2</em><em>,</em><em>2</em><em>)</em><em>; typically within</em><em> [</em><em>1-5</em><em>]</em>) – <p>Controls the refinement on the cell sizes. Can have up to a 20% impact
on runtime.</p>
<p>Only two refine factors are to be specified and these
correspond to <code class="docutils literal notranslate"><span class="pre">ra</span></code> and <code class="docutils literal notranslate"><span class="pre">dec</span></code> (rather, than the usual three of
<code class="docutils literal notranslate"><span class="pre">(xyz)bin_refine_factor</span></code> for all other correlation functions).</p>
</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^2. Only increase if <code class="docutils literal notranslate"><span class="pre">thetamax</span></code>
is too small relative to the boxsize (and increasing helps the
runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>enable_min_sep_opt</strong> (<em>boolean</em><em> (</em><em>default true</em><em>)</em>) – <p>Boolean flag to allow optimizations based on min. separation between
pairs of cells. Here to allow for comparison studies.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string, case-insensitive (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).</p>
<p>Unless you are benchmarking the different instruction sets, you should
always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if you <em>are</em>
benchmarking, then the string supplied here gets translated into an
<code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
<li><p><strong>weight_type</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default None</em><em>)</em>) – The type of weighting to apply.  One of [“pair_product”, None].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [thetamin, thetamax, thetaavg,
npairs, weightavg] for each angular bin specified in the <code class="docutils literal notranslate"><span class="pre">binfile</span></code>.
If <code class="docutils literal notranslate"><span class="pre">output_thetaavg</span></code> is not set then <code class="docutils literal notranslate"><span class="pre">thetavg</span></code> will be set to 0.0
for all bins; similarly for <code class="docutils literal notranslate"><span class="pre">weightavg</span></code>. <code class="docutils literal notranslate"><span class="pre">npairs</span></code> contains the
number of pairs in that bin.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.mocks.DDtheta_mocks</span> <span class="kn">import</span> <span class="n">DDtheta_mocks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binfile</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="s2">&quot;../mocks/tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;angular_bins&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DEC</span> <span class="o">=</span> <span class="mf">90.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cos_theta</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">RA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autocorr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">isa</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AVX&#39;</span><span class="p">,</span> <span class="s1">&#39;SSE42&#39;</span><span class="p">,</span> <span class="s1">&#39;FALLBACK&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">link_in_dec</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">link_in_ra</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]:</span>
<span class="gp">... </span>            <span class="n">results</span> <span class="o">=</span> <span class="n">DDtheta_mocks</span><span class="p">(</span><span class="n">autocorr</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">binfile</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">RA</span><span class="p">,</span> <span class="n">DEC</span><span class="p">,</span> <span class="n">output_thetaavg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">weights1</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">weight_type</span><span class="o">=</span><span class="s1">&#39;pair_product&#39;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">link_in_dec</span><span class="o">=</span><span class="n">link_in_dec</span><span class="p">,</span> <span class="n">link_in_ra</span><span class="o">=</span><span class="n">link_in_ra</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">isa</span><span class="o">=</span><span class="n">isa</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.6f}</span><span class="s2"> </span><span class="si">{1:10.6f}</span><span class="s2"> </span><span class="si">{2:10.6f}</span><span class="s2"> </span><span class="si">{3:10d}</span><span class="s2"> </span><span class="si">{4:10.6f}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="gp">... </span>                        <span class="nb">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;thetamin&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;thetamax&#39;</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;thetaavg&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;npairs&#39;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;weightavg&#39;</span><span class="p">]))</span>
<span class="gp">... </span>                        
<span class="go">  0.010000   0.014125   0.012272         62   1.000000</span>
<span class="go">  0.014125   0.019953   0.016978        172   1.000000</span>
<span class="go">  0.019953   0.028184   0.024380        298   1.000000</span>
<span class="go">  0.028184   0.039811   0.034321        598   1.000000</span>
<span class="go">  0.039811   0.056234   0.048535       1164   1.000000</span>
<span class="go">  0.056234   0.079433   0.068385       2438   1.000000</span>
<span class="go">  0.079433   0.112202   0.096631       4658   1.000000</span>
<span class="go">  0.112202   0.158489   0.136834       9414   1.000000</span>
<span class="go">  0.158489   0.223872   0.192967      19098   1.000000</span>
<span class="go">  0.223872   0.316228   0.272673      37848   1.000000</span>
<span class="go">  0.316228   0.446684   0.385344      75520   1.000000</span>
<span class="go">  0.446684   0.630957   0.543973     150938   1.000000</span>
<span class="go">  0.630957   0.891251   0.768406     301854   1.000000</span>
<span class="go">  0.891251   1.258925   1.085273     599896   1.000000</span>
<span class="go">  1.258925   1.778279   1.533461    1200238   1.000000</span>
<span class="go">  1.778279   2.511886   2.166009    2396338   1.000000</span>
<span class="go">  2.511886   3.548134   3.059159    4775162   1.000000</span>
<span class="go">  3.548134   5.011872   4.321445    9532582   1.000000</span>
<span class="go">  5.011872   7.079458   6.104214   19001930   1.000000</span>
<span class="go">  7.079458  10.000000   8.622400   37842502   1.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Corrfunc.mocks.vpf_mocks">
<code class="sig-prename descclassname">Corrfunc.mocks.</code><code class="sig-name descname">vpf_mocks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rmax</span></em>, <em class="sig-param"><span class="n">nbins</span></em>, <em class="sig-param"><span class="n">nspheres</span></em>, <em class="sig-param"><span class="n">numpN</span></em>, <em class="sig-param"><span class="n">threshold_ngb</span></em>, <em class="sig-param"><span class="n">centers_file</span></em>, <em class="sig-param"><span class="n">cosmology</span></em>, <em class="sig-param"><span class="n">RA</span></em>, <em class="sig-param"><span class="n">DEC</span></em>, <em class="sig-param"><span class="n">CZ</span></em>, <em class="sig-param"><span class="n">RAND_RA</span></em>, <em class="sig-param"><span class="n">RAND_DEC</span></em>, <em class="sig-param"><span class="n">RAND_CZ</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">is_comoving_dist</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">xbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">ybin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zbin_refine_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_cells_per_dim</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">copy_particles</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">c_api_timer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">isa</span><span class="o">=</span><span class="default_value">'fastest'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Corrfunc/mocks/vpf_mocks.html#vpf_mocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Corrfunc.mocks.vpf_mocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the counts-in-cells on points on the sky. Suitable
for mock catalogs and observed galaxies.</p>
<p>Returns a numpy structured array containing the probability of a
sphere of radius up to <code class="docutils literal notranslate"><span class="pre">rmax</span></code> containing <code class="docutils literal notranslate"><span class="pre">0--numpN-1</span></code> galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>double</em>) – Maximum radius of the sphere to place on the particles</p></li>
<li><p><strong>nbins</strong> (<em>integer</em>) – Number of bins in the counts-in-cells. Radius of first shell
is rmax/nbins</p></li>
<li><p><strong>nspheres</strong> (<em>integer</em><em> (</em><em>&gt;= 0</em><em>)</em>) – Number of random spheres to place within the particle distribution.
For a small number of spheres, the error is larger in the measured
pN’s.</p></li>
<li><p><strong>numpN</strong> (<em>integer</em><em> (</em><em>&gt;= 1</em><em>)</em>) – <p>Governs how many unique pN’s are to returned. If <code class="docutils literal notranslate"><span class="pre">numpN</span></code> is set to 1,
then only the vpf (p0) is returned. For <code class="docutils literal notranslate"><span class="pre">numpN=2</span></code>, p0 and p1 are
returned.</p>
<p>More explicitly, the columns in the results look like the following:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>numpN</p></th>
<th class="head"><p>Columns in output</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>p0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>p0      p1</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>p0      p1     p2</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>p0      p1     p2     p3</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>and so on…</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">p0</span></code> is the vpf</p>
</p></li>
<li><p><strong>threshold_ngb</strong> (<em>integer</em>) – Minimum number of random points needed in a <code class="docutils literal notranslate"><span class="pre">rmax</span></code> sphere such that
it is considered to be entirely within the mock footprint. The
command-line version, <code class="docutils literal notranslate"><span class="pre">mocks/vpf/vpf_mocks.c</span></code>, assumes that the
minimum number of randoms can be at most a 1-sigma deviation from
the expected random number density.</p></li>
<li><p><strong>centers_file</strong> (<em>string</em><em>, </em><em>filename</em>) – <p>A file containing random sphere centers. If the file does not exist,
then a list of random centers will be written out. In that case, the
randoms arrays, <code class="docutils literal notranslate"><span class="pre">RAND_RA</span></code>, <code class="docutils literal notranslate"><span class="pre">RAND_DEC</span></code> and <code class="docutils literal notranslate"><span class="pre">RAND_CZ</span></code> are used to
check that the sphere is entirely within the footprint. If the file
does exist but either <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is too small or there are not enough
centers then the file will be overwritten.</p>
<p>Note: If the centers file has to be written, the code will take
significantly longer to finish. However, subsequent runs can re-use
that centers file and will be faster.</p>
</p></li>
<li><p><strong>cosmology</strong> (<em>integer</em><em>, </em><em>required</em>) – <p>Integer choice for setting cosmology. Valid values are 1-&gt;LasDamas
cosmology and 2-&gt;Planck cosmology. If you need arbitrary cosmology,
easiest way is to convert the <code class="docutils literal notranslate"><span class="pre">CZ</span></code> values into co-moving distance,
based on your preferred cosmology. Set <code class="docutils literal notranslate"><span class="pre">is_comoving_dist=True</span></code>, to
indicate that the co-moving distance conversion has already been done.</p>
<dl class="simple">
<dt>Choices:</dt><dd><ol class="arabic simple">
<li><p>LasDamas cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.25\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.75\)</span></p></li>
<li><p>Planck   cosmology. <span class="math notranslate nohighlight">\(\Omega_m=0.302\)</span>, <span class="math notranslate nohighlight">\(\Omega_\Lambda=0.698\)</span></p></li>
</ol>
</dd>
</dl>
<p>To setup a new cosmology, add an entry to the function,
<code class="docutils literal notranslate"><span class="pre">init_cosmology</span></code> in <code class="docutils literal notranslate"><span class="pre">ROOT/utils/cosmology_params.c</span></code> and re-install
the entire package.</p>
</p></li>
<li><p><strong>RA</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the first set of points. RA’s
are expected to be in [0.0, 360.0], but the code will try to fix cases
where the RA’s are in [-180, 180.0]. For peace of mind, always supply
RA’s in [0.0, 360.0].</p>
<p>Calculations are done in the precision of the supplied arrays.</p>
</p></li>
<li><p><strong>DEC</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the first set of points. DEC’s are expected
to be in the [-90.0, 90.0], but the code will try to fix cases where
the DEC’s are in [0.0, 180.0]. Again, for peace of mind, always supply
DEC’s in [-90.0, 90.0].</p>
<p>Must be of same precision type as RA.</p>
</p></li>
<li><p><strong>CZ</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the first set of
points. Code will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">is_comoving_dist</span></code> is set, then <code class="docutils literal notranslate"><span class="pre">CZ</span></code> is interpreted as the
co-moving distance, rather than (Speed Of Light * Redshift).</p>
</p></li>
<li><p><strong>RAND_RA</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>The array of Right Ascensions for the randoms. RA’s are expected to be
in [0.0, 360.0], but the code will try to fix cases where the RA’s are
in [-180, 180.0]. For peace of mind, always supply RA’s in
[0.0, 360.0].</p>
<p>Must be of same precision type as RA/DEC/CZ.</p>
</p></li>
<li><p><strong>RAND_DEC</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of Declinations for the randoms. DEC’s are expected to be in the
[-90.0, 90.0], but the code will try to fix cases where the DEC’s are
in [0.0, 180.0]. Again, for peace of mind, always supply DEC’s in
[-90.0, 90.0].</p>
<p>Must be of same precision type as RA/DEC/CZ.</p>
</p></li>
<li><p><strong>RAND_CZ</strong> (<em>array-like</em><em>, </em><em>real</em><em> (</em><em>float/double</em><em>)</em>) – <p>Array of (Speed Of Light * Redshift) values for the randoms. Code
will try to detect cases where <code class="docutils literal notranslate"><span class="pre">redshifts</span></code> have been
passed and multiply the entire array with the <code class="docutils literal notranslate"><span class="pre">speed</span> <span class="pre">of</span> <span class="pre">light</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">is_comoving_dist</span></code> is set, then <code class="docutils literal notranslate"><span class="pre">CZ2</span></code> is interpreted as the
co-moving distance, rather than <code class="docutils literal notranslate"><span class="pre">(Speed</span> <span class="pre">Of</span> <span class="pre">Light</span> <span class="pre">*</span> <span class="pre">Redshift)</span></code>.</p>
<dl class="simple">
<dt>Note: RAND_RA, RAND_DEC and RAND_CZ are only used when the</dt><dd><p><code class="docutils literal notranslate"><span class="pre">centers_file</span></code>  needs to be written out. In that case, the
RAND_RA, RAND_DEC, and RAND_CZ are used as random centers.</p>
</dd>
</dl>
</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to control output of informational messages</p></li>
<li><p><strong>is_comoving_dist</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to indicate that <code class="docutils literal notranslate"><span class="pre">cz</span></code> values have already been
converted into co-moving distances. This flag allows arbitrary
cosmologies to be used in <code class="docutils literal notranslate"><span class="pre">Corrfunc</span></code>.</p></li>
<li><p><strong>(</strong><strong>xyz</strong><strong>)</strong><strong>bin_refine_factor</strong> (<em>integer</em><em>, </em><em>default is</em><em> (</em><em>1</em><em>, </em><em>1</em><em>, </em><em>1</em><em>)</em><em>; typically in</em><em> [</em><em>1-2</em><em>]</em>) – <p>Controls the refinement on the cell sizes. Higher numbers might have
a negative impact on runtime.</p>
<p>Note: Since the counts in spheres calculation is symmetric
in all 3 dimensions, the defaults are different from the clustering
routines.</p>
</p></li>
<li><p><strong>max_cells_per_dim</strong> (<em>integer</em><em>, </em><em>default is 100</em><em>, </em><em>typical values in</em><em> [</em><em>50-300</em><em>]</em>) – Controls the maximum number of cells per dimension. Total number of
cells can be up to (max_cells_per_dim)^3. Only increase if <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is
too small relative to the boxsize (and increasing helps the runtime).</p></li>
<li><p><strong>copy_particles</strong> (<em>boolean</em><em> (</em><em>default True</em><em>)</em>) – <p>Boolean flag to make a copy of the particle positions
If set to False, the particles will be re-ordered in-place</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.3.0.</span></p>
</div>
</p></li>
<li><p><strong>c_api_timer</strong> (<em>boolean</em><em> (</em><em>default false</em><em>)</em>) – Boolean flag to measure actual time spent in the C libraries. Here
to allow for benchmarking and scaling studies.</p></li>
<li><p><strong>isa</strong> (string, case-insensitive (default <code class="docutils literal notranslate"><span class="pre">fastest</span></code>)) – <p>Controls the runtime dispatch for the instruction set to use. Options
are: [<code class="docutils literal notranslate"><span class="pre">fastest</span></code>, <code class="docutils literal notranslate"><span class="pre">avx512f</span></code>, <code class="docutils literal notranslate"><span class="pre">avx</span></code>, <code class="docutils literal notranslate"><span class="pre">sse42</span></code>, <code class="docutils literal notranslate"><span class="pre">fallback</span></code>]</p>
<p>Setting isa to <code class="docutils literal notranslate"><span class="pre">fastest</span></code> will pick the fastest available instruction
set on the current computer. However, if you set <code class="docutils literal notranslate"><span class="pre">isa</span></code> to, say,
<code class="docutils literal notranslate"><span class="pre">avx</span></code> and <code class="docutils literal notranslate"><span class="pre">avx</span></code> is not available on the computer, then the code
will revert to using <code class="docutils literal notranslate"><span class="pre">fallback</span></code> (even though <code class="docutils literal notranslate"><span class="pre">sse42</span></code> might be
available).</p>
<p>Unless you are benchmarking the different instruction sets, you should
always leave <code class="docutils literal notranslate"><span class="pre">isa</span></code> to the default value. And if you <em>are</em>
benchmarking, then the string supplied here gets translated into an
<code class="docutils literal notranslate"><span class="pre">enum</span></code> for the instruction set defined in <code class="docutils literal notranslate"><span class="pre">utils/defs.h</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>Numpy structured array</em>) – A numpy structured array containing [rmax, pN[numpN]] with <code class="docutils literal notranslate"><span class="pre">nbins</span></code>
elements. Each row contains the maximum radius of the sphere and the
<code class="docutils literal notranslate"><span class="pre">numpN</span></code> elements in the <code class="docutils literal notranslate"><span class="pre">pN</span></code> array. Each element of this array
contains the probability that a sphere of radius <code class="docutils literal notranslate"><span class="pre">rmax</span></code> contains
<em>exactly</em> <code class="docutils literal notranslate"><span class="pre">N</span></code> galaxies. For example, pN[0] (p0, the void probibility
function) is the probability that a sphere of radius <code class="docutils literal notranslate"><span class="pre">rmax</span></code> contains
0 galaxies.</p></li>
<li><p><strong>api_time</strong> (<em>float, optional</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">c_api_timer</span></code> is set.  <code class="docutils literal notranslate"><span class="pre">api_time</span></code> measures only
the time spent within the C library and ignores all python overhead.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Corrfunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Corrfunc.mocks.vpf_mocks</span> <span class="kn">import</span> <span class="n">vpf_mocks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rmax</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numbins_to_print</span> <span class="o">=</span> <span class="n">nbins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nspheres</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpN</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold_ngb</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># does not matter since we have the centers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmology</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># LasDamas cosmology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers_file</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="n">Corrfunc</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)),</span>
<span class="gp">... </span>                     <span class="s2">&quot;../mocks/tests/data/&quot;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="s2">&quot;Mr19_centers_xyz_forVPF_rmax_10Mpc.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span> <span class="n">Z</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_cz</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">CZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">*=</span> <span class="n">inv_cz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DEC</span> <span class="o">=</span> <span class="mf">90.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RA</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">vpf_mocks</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">nspheres</span><span class="p">,</span> <span class="n">numpN</span><span class="p">,</span> <span class="n">threshold_ngb</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">centers_file</span><span class="p">,</span> <span class="n">cosmology</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">RA</span><span class="p">,</span> <span class="n">DEC</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">RA</span><span class="p">,</span> <span class="n">DEC</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">is_comoving_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.1f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>    
<span class="gp">... </span>    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:10.3f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pn</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>        
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> 
<span class="go">   1.0      0.999      0.001      0.000      0.000      0.000      0.000</span>
<span class="go">   2.0      0.992      0.007      0.001      0.000      0.000      0.000</span>
<span class="go">   3.0      0.982      0.009      0.005      0.002      0.001      0.000</span>
<span class="go">   4.0      0.975      0.006      0.006      0.005      0.003      0.003</span>
<span class="go">   5.0      0.971      0.004      0.003      0.003      0.004      0.003</span>
<span class="go">   6.0      0.967      0.003      0.003      0.001      0.003      0.002</span>
<span class="go">   7.0      0.962      0.004      0.002      0.003      0.002      0.001</span>
<span class="go">   8.0      0.958      0.004      0.002      0.003      0.001      0.002</span>
<span class="go">   9.0      0.953      0.003      0.003      0.002      0.003      0.001</span>
<span class="go">  10.0      0.950      0.003      0.002      0.002      0.001      0.002</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/corrfunc_logo_320px_240px.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="Corrfunc.bases.html"
                        title="previous chapter">Corrfunc.bases package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Corrfunc.theory.html"
                        title="next chapter">Corrfunc.theory package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/Corrfunc.mocks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Corrfunc.theory.html" title="Corrfunc.theory package"
             >next</a> |</li>
        <li class="right" >
          <a href="Corrfunc.bases.html" title="Corrfunc.bases package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Corrfunc v0.0.4</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Comprehensive API reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Corrfunc.html" >Corrfunc package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Corrfunc.mocks package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2020, Kate Storey-Fisher &lt;kstoreyfisher@gmail.com&gt;.
      Last updated on Sep 14, 2020.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>