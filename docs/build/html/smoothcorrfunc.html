
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smoothcorrfunc &#8212; Corrfunc v0.0.4</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="_static/corrfunc-logo-no-text.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Corrfunc v0.0.4</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Smoothcorrfunc</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="smoothcorrfunc">
<h1>Smoothcorrfunc<a class="headerlink" href="#smoothcorrfunc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Smoothcorrfunc is a generalized estimator of the two-point correlation function (2pcf) for cosmology. The 2pcf is the most important statistic for the analysis of large-scale structure; it measures the strength of clustering (e.g. of galaxies) as a function of separation. Smoothcorrfunc replaces the standard binning in separation with a projection of galaxy pair counts onto any set of basis functions. The choice of basis functions can preserve more information for improved bias and variance properties, include other galaxy information, and be specific to the science use case.</p>
<p>The source code is publicly available at <a class="reference external" href="https://github.com/kstoreyf/Corrfunc">https://github.com/kstoreyf/Corrfunc</a>. The paper is forthcoming.</p>
<p>This implementation of the Smoothcorrfunc estimator is built on top of the <a class="reference external" href="https://github.com/kstoreyf/Corrfunc">Corrfunc</a> package [cite]. As such, all of the Corrfunc functionality is accessible through Smoothcorrfunc. Here we only document the new and updated functionality of Smoothcorrfunc; for full Corrfunc usage, see <a class="reference external" href="https://corrfunc.readthedocs.io">https://corrfunc.readthedocs.io</a>.</p>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>Here we demonstrate the basic usage of the estimator by computing a typical correlation function with tophat bins, but in a continuous basis.</p>
<p>Load in a data catalog (in a periodic cube) and generate a random catalog:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">boxsize</span> <span class="o">=</span> <span class="mf">750.0</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">read_lognormal_catalog</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s1">&#39;3e-4&#39;</span><span class="p">)</span>
<span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">nr</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">nd</span>
<span class="n">x_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">nr</span><span class="p">)</span>
<span class="n">y_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">nr</span><span class="p">)</span>
<span class="n">z_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boxsize</span><span class="p">,</span> <span class="n">nr</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the tophat basis, set the <cite>proj_type</cite> accordingly and choose radial separation bins. To compute the full 3D correlation function, we can use the 2D correlation function DD(s, mu) with a single mu bin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj_type</span> <span class="o">=</span> <span class="s1">&#39;tophat&#39;</span>
<span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">nprojbins</span> <span class="o">=</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mi">22</span>
<span class="n">r_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">nprojbins</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nmubins</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mumax</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">periodic</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">nthreads</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Compute the component vectors DD, DR, and RR, which in this case are equivalent to the pair counts, and the component tensor QQ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dd_res</span><span class="p">,</span> <span class="n">dd_proj</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DDsmu</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">,</span> <span class="n">mumax</span><span class="p">,</span> <span class="n">nmubins</span><span class="p">,</span>
                           <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">boxsize</span><span class="o">=</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="n">periodic</span><span class="p">,</span>
                           <span class="n">proj_type</span><span class="o">=</span><span class="n">proj_type</span><span class="p">,</span> <span class="n">nprojbins</span><span class="o">=</span><span class="n">nprojbins</span><span class="p">)</span>
<span class="n">dr_res</span><span class="p">,</span> <span class="n">dr_proj</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">DDsmu</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">,</span> <span class="n">mumax</span><span class="p">,</span> <span class="n">nmubins</span><span class="p">,</span>
                           <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="n">x_rand</span><span class="p">,</span> <span class="n">Y2</span><span class="o">=</span><span class="n">y_rand</span><span class="p">,</span> <span class="n">Z2</span><span class="o">=</span><span class="n">z_rand</span><span class="p">,</span>
                           <span class="n">boxsize</span><span class="o">=</span><span class="n">boxsize</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="n">periodic</span><span class="p">,</span>
                           <span class="n">proj_type</span><span class="o">=</span><span class="n">proj_type</span><span class="p">,</span> <span class="n">nprojbins</span><span class="o">=</span><span class="n">nprojbins</span><span class="p">)</span>
<span class="n">rr_res</span><span class="p">,</span> <span class="n">rr_proj</span><span class="p">,</span> <span class="n">qq_proj</span> <span class="o">=</span> <span class="n">DDsmu</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nthreads</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">,</span> <span class="n">mumax</span><span class="p">,</span> <span class="n">nmubins</span><span class="p">,</span>
                                 <span class="n">x_rand</span><span class="p">,</span> <span class="n">y_rand</span><span class="p">,</span> <span class="n">z_rand</span><span class="p">,</span> <span class="n">boxsize</span><span class="o">=</span><span class="n">boxsize</span><span class="p">,</span>
                                 <span class="n">periodic</span><span class="o">=</span><span class="n">periodic</span><span class="p">,</span> <span class="n">proj_type</span><span class="o">=</span><span class="n">proj_type</span><span class="p">,</span>
                                 <span class="n">nprojbins</span><span class="o">=</span><span class="n">nprojbins</span><span class="p">)</span>
</pre></div>
</div>
<p>From the component vectors, compute the amplitudes, and evaluate the correlation function on a fine r-grid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">amps</span> <span class="o">=</span> <span class="n">compute_amps</span><span class="p">(</span><span class="n">nprojbins</span><span class="p">,</span> <span class="n">nd</span><span class="p">,</span> <span class="n">nd</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">dd_proj</span><span class="p">,</span> <span class="n">dr_proj</span><span class="p">,</span> <span class="n">dr_proj</span><span class="p">,</span> <span class="n">rr_proj</span><span class="p">,</span> <span class="n">qq_proj</span><span class="p">)</span>
<span class="n">r_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">evaluate_xi</span><span class="p">(</span><span class="n">amps</span><span class="p">,</span> <span class="n">r_fine</span><span class="p">,</span> <span class="n">proj_type</span><span class="p">,</span> <span class="n">rbins</span><span class="o">=</span><span class="n">r_edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="demo-notebooks">
<h2>Demo notebooks<a class="headerlink" href="#demo-notebooks" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_theory.html">Demo Notebook: The Continuous-Function Estimator</a></li>
</ul>
</div>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/smoothmodules.html">Smoothcorrfunc package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/smoothmodules.html#corrfunc-theory-ddsmu">Corrfunc.theory.DDsmu</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/smoothmodules.html#corrfunc-mocks-ddsmu-mocks">Corrfunc.mocks.DDsmu_mocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/smoothmodules.html#corrfunc-utils">Corrfunc.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/smoothmodules.html#corrfunc-bases-module">Corrfunc.bases module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/Corrfunc.bases.html">Corrfunc.bases package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/Corrfunc.bases.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/Corrfunc.bases.html#module-Corrfunc.bases.bao">Corrfunc.bases.bao module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/Corrfunc.bases.html#module-Corrfunc.bases.dcosmo">Corrfunc.bases.dcosmo module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/Corrfunc.bases.html#module-Corrfunc.bases.spline">Corrfunc.bases.spline module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="license-and-credits">
<h2>License and Credits<a class="headerlink" href="#license-and-credits" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/smoothdev.html">Contributors and License</a></li>
</ul>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/corrfunc_logo_320px_240px.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Smoothcorrfunc</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li><a class="reference internal" href="#demo-notebooks">Demo notebooks</a></li>
<li><a class="reference internal" href="#api-reference">API Reference</a></li>
<li><a class="reference internal" href="#license-and-credits">License and Credits</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/smoothcorrfunc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Corrfunc v0.0.4</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Smoothcorrfunc</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2020, Kate Storey-Fisher &lt;kstoreyfisher@gmail.com&gt;.
      Last updated on Sep 14, 2020.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>